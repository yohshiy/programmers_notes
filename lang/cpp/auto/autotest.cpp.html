<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.51 in css mode. -->
<html>
  <head>
    <title>autotest.cpp</title>
    <style type="text/css">
    <!--
      body {
        color: SystemWindowText;
        background-color: SystemWindow;
      }
      .comment {
        /* font-lock-comment-face */
        color: #b22222;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #b22222;
      }
      .constant {
        /* font-lock-constant-face */
        color: #008b8b;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #0000ff;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #a020f0;
      }
      .preprocessor {
        /* font-lock-preprocessor-face */
        color: #483d8b;
      }
      .string {
        /* font-lock-string-face */
        color: #8b2252;
      }
      .type {
        /* font-lock-type-face */
        color: #228b22;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #a0522d;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment-delimiter">/// </span><span class="comment">@file
</span><span class="comment-delimiter">/// </span><span class="comment">auto samples
</span><span class="comment-delimiter">///</span><span class="comment">
</span><span class="comment-delimiter">///     </span><span class="comment">$ g++ -std=c++14 autotest.cpp
</span><span class="comment-delimiter">/// </span><span class="comment">
</span>
<span class="preprocessor">#include</span> <span class="string">&lt;iostream&gt;</span>
<span class="preprocessor">#include</span> <span class="string">&lt;stdint.h&gt;</span>
<span class="preprocessor">#include</span> <span class="string">&lt;typeinfo&gt;</span>


<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="constant">std</span>;

<span class="type">int</span> <span class="function-name">foofunc</span>()
{
  <span class="comment-delimiter">// </span><span class="comment">&#12525;&#12540;&#12459;&#12523;&#22793;&#25968;
</span>  <span class="keyword">auto</span> <span class="variable-name">localver</span> = 1;

  <span class="comment-delimiter">// </span><span class="comment">&#12522;&#12486;&#12521;&#12523;&#12398;&#24037;&#22827;
</span>  <span class="keyword">const</span> <span class="keyword">auto</span> cstr = <span class="string">"Hellow"</span>;  <span class="comment-delimiter">// </span><span class="comment">const char *
</span>  <span class="keyword">auto</span> <span class="variable-name">str</span> = <span class="string">"Hellow"</span>s;        <span class="comment-delimiter">// </span><span class="comment">std::string
</span>  cout &lt;&lt; cstr &lt;&lt; endl;
  cout &lt;&lt; str  &lt;&lt; endl;

  <span class="keyword">return</span> localver;
}


<span class="comment-delimiter">/// </span><span class="comment">&#12464;&#12525;&#12540;&#12496;&#12523;&#22793;&#25968;
</span><span class="keyword">extern</span> <span class="type">int64_t</span> <span class="variable-name">ErrNo</span>;

<span class="comment-delimiter">// </span><span class="comment">static &#22793;&#25968;
</span><span class="keyword">static</span> <span class="keyword">auto</span> <span class="variable-name">stvar</span> = 1.0;

<span class="comment-delimiter">/// </span><span class="comment">&#12464;&#12525;&#12540;&#12496;&#12523;&#23450;&#25968;
</span><span class="keyword">const</span> <span class="keyword">auto</span> VERION = <span class="string">"1.0.0"</span>;




<span class="keyword">class</span> <span class="type">Foo</span>
{
  <span class="comment-delimiter">/// </span><span class="comment">&#12513;&#12531;&#12496;&#12540;&#22793;&#25968;
</span>  <span class="type">int</span> <span class="variable-name">m_bar</span> = 0;
  <span class="comment-delimiter">// </span><span class="comment">auto m_baz = 0; NG
</span>
  <span class="comment-delimiter">/// </span><span class="comment">&#12463;&#12521;&#12473;&#22793;&#25968;
</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="type">int</span> <span class="variable-name">Dim</span> = 2;
  <span class="comment-delimiter">// </span><span class="comment">static int Dim = 2; NG const &#12398;&#12415; OK
</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="type">double</span> <span class="variable-name">Mag</span> = 0.5;

  <span class="comment-delimiter">/// </span><span class="comment">&#12463;&#12521;&#12473;&#22793;&#25968; (Auto)
</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> DimAuto = 2;
  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> MagAuto = 0.5;
};



<span class="comment-delimiter">////////////////////////////////////////////////////////////////</span><span class="comment">
</span>

<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>&gt;
<span class="keyword">auto</span> <span class="function-name">StdMax</span>(<span class="keyword">const</span> <span class="type">T</span> &amp;<span class="variable-name">a</span>, <span class="keyword">const</span> <span class="type">T</span> &amp;<span class="variable-name">b</span>)
{
  <span class="keyword">return</span> (a &lt; b) ? b : a;
}

<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>, <span class="keyword">typename</span> <span class="type">U</span>&gt;
<span class="keyword">auto</span> <span class="function-name">MyMax</span>(<span class="keyword">const</span> <span class="type">T</span> &amp;<span class="variable-name">a</span>, <span class="keyword">const</span> <span class="type">U</span> &amp;<span class="variable-name">b</span>)
{
  <span class="keyword">return</span> (a &lt; b) ? b : a;
}


<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>, <span class="keyword">typename</span> <span class="type">U</span>&gt;
<span class="keyword">auto</span> <span class="function-name">MyMax2Return</span>(<span class="keyword">const</span> <span class="type">T</span> &amp;<span class="variable-name">a</span>, <span class="keyword">const</span> <span class="type">U</span> &amp;<span class="variable-name">b</span>)
{
  <span class="keyword">if</span> (a &lt; b) {
    <span class="keyword">return</span> b;
  }
  <span class="keyword">else</span> {
    <span class="keyword">return</span> a;
  }
}


<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>, <span class="keyword">typename</span> <span class="type">U</span>&gt;
<span class="keyword">auto</span> <span class="function-name">FixedMyMax2Return</span>(<span class="keyword">const</span> <span class="type">T</span> &amp;<span class="variable-name">a</span>, <span class="keyword">const</span> <span class="type">U</span> &amp;<span class="variable-name">b</span>) -&gt; <span class="keyword">decltype</span>(a+b)
{
  <span class="keyword">if</span> (a &lt; b) {
    <span class="keyword">return</span> b;
  }
  <span class="keyword">else</span> {
    <span class="keyword">return</span> a;
  }
}

<span class="comment-delimiter">////////////////////////////////////////////////////////////////</span><span class="comment">
</span>
<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>&gt;
<span class="keyword">struct</span> <span class="type">Point</span>
{
  <span class="type">T</span> <span class="variable-name">x</span>;
  <span class="type">T</span> <span class="variable-name">y</span>;

  <span class="function-name">Point</span>(<span class="type">T</span> <span class="variable-name">ax</span>, <span class="type">T</span> <span class="variable-name">ay</span>)
      :x(ax), <span class="type">y</span>(<span class="variable-name">ay</span>) {}

<span class="preprocessor">#if</span> 0
  <span class="comment-delimiter">// </span><span class="comment">&#12467;&#12531;&#12497;&#12452;&#12523;&#12399;&#36890;&#12425;&#12394;&#12356;
</span>  <span class="keyword">auto</span> <span class="variable-name">Plus</span>(<span class="keyword">auto</span> <span class="variable-name">val</span>) <span class="keyword">const</span>
  {
    <span class="keyword">return</span> Point&lt;<span class="keyword">decltype</span>(x+val)&gt;(<span class="keyword">static_cast</span>&lt;T&gt;(x+val), <span class="keyword">static_cast</span>&lt;T&gt;(y+val));
  }
<span class="preprocessor">#endif</span>

  <span class="comment-delimiter">// </span><span class="comment">&#24341;&#25968;&#12384;&#12369; auto
</span>  <span class="type">Point</span> <span class="variable-name">PlusAutoArg</span>(<span class="keyword">auto</span> <span class="variable-name">val</span>) <span class="keyword">const</span>
  {
    <span class="keyword">return</span> Point(<span class="keyword">static_cast</span>&lt;T&gt;(x+val), <span class="keyword">static_cast</span>&lt;T&gt;(y+val));
  }

  <span class="comment-delimiter">// </span><span class="comment">&#25147;&#12426;&#20516;&#12384;&#12369; auto
</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">U</span>&gt;
  <span class="keyword">auto</span> <span class="function-name">PlusAutoReturn</span>(<span class="type">U</span> <span class="variable-name">val</span>) <span class="keyword">const</span>
  {
    <span class="keyword">return</span> Point&lt;<span class="keyword">decltype</span>(x+val)&gt;(x+val, y+val);
  }


};

<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>&gt;
<span class="constant">std</span>::<span class="type">ostream</span> &amp;<span class="keyword">operator</span><span class="function-name">&lt;&lt;</span>(<span class="constant">std</span>::<span class="type">ostream</span> &amp;<span class="variable-name">out</span>, <span class="keyword">const</span> <span class="type">Point</span>&lt;<span class="type">T</span>&gt; &amp;<span class="variable-name">p</span>)
{
  out &lt;&lt; <span class="string">"Point("</span> &lt;&lt; p.x &lt;&lt; <span class="string">", "</span> &lt;&lt; p.y &lt;&lt; <span class="string">")"</span>;
  <span class="keyword">return</span> out;
}


<span class="preprocessor">#if</span> 1

<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>, <span class="keyword">typename</span> <span class="type">U</span>&gt;
<span class="keyword">inline</span> <span class="keyword">auto</span> <span class="keyword">operator</span><span class="function-name">*</span>(<span class="keyword">const</span> <span class="type">Point</span>&lt;<span class="type">T</span>&gt; &amp;<span class="variable-name">a</span>, <span class="type">U</span> <span class="variable-name">b</span>)
{
  <span class="keyword">return</span> Point&lt;<span class="keyword">decltype</span>(a.x*b)&gt;(a.x*b, a.y*b);
}

<span class="preprocessor">#else</span>

<span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="type">T</span>, <span class="keyword">typename</span> <span class="type">U</span>&gt;
<span class="keyword">inline</span> <span class="keyword">auto</span> <span class="keyword">operator</span><span class="function-name">*</span>(<span class="keyword">const</span> <span class="type">Point</span>&lt;<span class="type">T</span>&gt; &amp;<span class="variable-name">a</span>, <span class="type">U</span> <span class="variable-name">b</span>) -&gt; <span class="type">Point</span>&lt;<span class="keyword">decltype</span>(a.x*b)&gt;
{
  <span class="keyword">return</span> {a.x*b, a.y*b};
}

<span class="preprocessor">#endif</span>



<span class="type">int</span> <span class="function-name">main</span>()
{      
  cout &lt;&lt; StdMax(4, 12) &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">12
</span>
  cout &lt;&lt; MyMax(4.2, 12) &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">12
</span>  cout &lt;&lt; MyMax(4.2,  2) &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">4.2
</span>
  cout &lt;&lt; MyMax2Return(4, 12) &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">12
</span>  <span class="comment-delimiter">// </span><span class="comment">cout &lt;&lt; MyMax2Return(4.2, 12) &lt;&lt; endl;  // &#12467;&#12531;&#12497;&#12452;&#12523;&#12456;&#12521;&#12540;  
</span>  cout &lt;&lt; endl;
  
  cout &lt;&lt; FixedMyMax2Return(4.2, 12) &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">12.0
</span>  cout &lt;&lt; FixedMyMax2Return(4.2,  2) &lt;&lt; endl;  <span class="comment-delimiter">//  </span><span class="comment">4.2
</span>
  cout &lt;&lt; endl;

  
  cout &lt;&lt; Point&lt;<span class="type">int</span>&gt;(3, 2) * 0.5 &lt;&lt; endl;  <span class="comment-delimiter">// </span><span class="comment">Point&lt;double&gt;(1.5, 1.0)
</span>
  <span class="type">Point</span>&lt;<span class="type">int</span>&gt; <span class="variable-name">pos</span>(3, 2);
  cout &lt;&lt; pos.PlusAutoArg(2.5) &lt;&lt; endl;    <span class="comment-delimiter">// </span><span class="comment">Point(5, 4)
</span>  cout &lt;&lt; pos.PlusAutoReturn(2.5) &lt;&lt; endl; <span class="comment-delimiter">// </span><span class="comment">Point(5.5, 4.5)
</span>
  
  <span class="keyword">auto</span> <span class="variable-name">plus</span> = [](<span class="keyword">auto</span> <span class="variable-name">a</span>, <span class="keyword">auto</span> <span class="variable-name">b</span>) { <span class="keyword">return</span> a + b; };
  cout &lt;&lt; plus(2,   3) &lt;&lt; endl; <span class="comment-delimiter">// </span><span class="comment">result = 5
</span>  cout &lt;&lt; plus(2.5, 3) &lt;&lt; endl; <span class="comment-delimiter">// </span><span class="comment">result = 5.5
</span>  
  <span class="keyword">return</span> 0;
}

</pre>
  </body>
</html>
